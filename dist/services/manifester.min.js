/*! Manifest 2024-01-14 */
const express=require("express"),app=express(),url=require("url"),request=require("request-promise"),gsheetkey="AIzaSyDbKq9njfiQa3UDGzRaaG0YaQOT0kYNoFQ",aprsfikey="161937.xJdpU4VkxgfJ2EA",port=3e3;app.listen(port,()=>{console.log(`Server running at http://localhost:${port}/`)}),app.get("/",(e,s)=>{let o={g:null,r:null,getSmapGeo:function(e){return request({method:"GET",uri:"https://raw.githubusercontent.com/hock/smapdata/master/data/"+e+".geojson",json:!0})},getSmapGraph:function(e){return request({method:"GET",uri:"https://raw.githubusercontent.com/hock/smapdata/master/data/"+e+".json",json:!0})},getGoogleOverview:function(e){return request({uri:"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/Overview?key="+gsheetkey,json:!0})},getGoogleList:function(e){return request({method:"GET",uri:"https://sheets.googleapis.com/v4/spreadsheets/"+e+"/values/List?key="+gsheetkey,json:!0})},getMarineTrafficOverview:function(){return request({method:"GET",uri:"http://services.marinetraffic.com/api/exportvessels/cc503f48eb2c8e49549cc56de3c7059c4b042931/timespan:4/protocol:json",json:!0})},getAprsFi:function(e){return request({method:"GET",uri:"https://api.aprs.fi/api/get?name="+e+"&what=loc&apikey="+aprsfikey+"&format=json",headers:{"User-Agent":"manifest/0.2 (+https://manifest.supplystudies.com/)"},json:!0})}};let n=url.parse(e.url,!0).query;if("smap"==n.type||"gsheet"==n.type){let e=null,t=null;"smap"==n.type&&(e=o.getSmapGeo,t=o.getSmapGraph),"gsheet"==n.type&&(e=o.getGoogleOverview,t=o.getGoogleList),e(n.id).then(function(e){o.g=e,t(n.id).then(function(e){o.r=e,s.statusCode=200,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),console.log("done"),s.end('{"g": '+JSON.stringify(o.g)+', "r": '+JSON.stringify(o.r)+"}")}).catch(function(e){console.log("failed"),s.statusCode=404,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),s.end('{"not found"}')})}).catch(function(e){console.log("failed"),s.statusCode=404,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),s.end('{"not found"}')})}"proxy-marine"==n.type&&o.getMarineTrafficOverview().then(function(e){s.statusCode=200,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),console.log("success"),s.end(JSON.stringify(e))}).catch(function(e){console.log("failed"),s.statusCode=404,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),s.end('{"not found"}')}),"aprsfi"==n.type&&o.getAprsFi(n.id).then(function(e){s.statusCode=200,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),console.log("success"),s.end(JSON.stringify(e))}).catch(function(e){console.log("failed"),s.statusCode=404,s.setHeader("Access-Control-Allow-Origin","*"),s.setHeader("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept"),s.setHeader("Access-Control-Allow-Methods","GET"),s.setHeader("Content-Type","application/json"),s.end('{"error: "RESOURCE NOT FOUND"}')})});
//# sourceMappingURL=manifester.min.js.map